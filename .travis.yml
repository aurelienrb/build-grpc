language: cpp
sudo: false

env:
  global:
    GRPC_VERSION=v1.0.1

matrix:
  include:
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - golang
        - gcc-4.8
        - g++-4.8
    script:
    - env CC=gcc-4.8 CXX=g++-4.8 ./build_grpc.sh $GRPC_VERSION
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - golang
        - gcc-5
        - g++-5
    script:
    - env CC=gcc-5 CXX=g++-5 ./build_grpc.sh $GRPC_VERSION
  - compiler: gcc
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        packages:
        - golang
        - gcc-6
        - g++-6
    script:
    - env CC=gcc-6 CXX=g++-6 ./build_grpc.sh $GRPC_VERSION
  - compiler: clang
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-precise-3.5
        packages:
        - golang
        - clang-3.5
    script:
    - env CC=clang-3.5 CXX=clang++-3.5 ./build_grpc.sh $GRPC_VERSION
  - compiler: clang
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-precise-3.7
        packages:
        - golang
        - clang-3.7
    script:
    - env CC=clang-3.7 CXX=clang++-3.7 ./build_grpc.sh $GRPC_VERSION
  - compiler: clang
    addons:
      apt:
        sources:
        - ubuntu-toolchain-r-test
        - llvm-toolchain-precise-3.8
        packages:
        - golang
        - clang-3.8
    script:
    - env CC=clang-3.8 CXX=clang++-3.8 ./build_grpc.sh $GRPC_VERSION

before_script:
- echo "TRAVIS_TAG=$TRAVIS_TAG"
- echo "GRPC_VERSION=$GRPC_VERSION"
- uname -a
- ls

after_script:
- ls

notifications:
  email: false

deploy:
  provider: releases
  skip_cleanup: true
  overwrite: true
  api_key:
    secure: he0yEY/zt8J8xDn0x5GzcY6rEkw/4QkY43Em2LVgcJxBcVqPeACaqL5xuzCHlYRTqiSvueDnzlDAZAlQiBDXg4nK0VtWCQSr4pi3GuOCco8GKH8cK5cdhPsBwPHA6I38+gWFk4YMpez1DZcNN5x/0Qa9ug37B1xgTN/zioJRaipr+bg6uDFfD0pEV2SvUJQ/FTxtTyHDQfmHM5Eu1bn+KTBKJgF+IKrrUpI0Ny2yUmmdRQtxtkjbBUNB3IUeTa+ySCJakTWrARfr1gEWeLljrMxtoqtVERd/c/pnEhu3zdSGx8+q6/pC/pzmV1olmE9uijMnX84ufP0ClmkiFhyKktmg+BD7ijZHcr1dcaB1AycBoVBdoi+YAt84wG/jfKMN1xp1S6qHGyvaX0xvVmx0V4KWrFDEQLU3RNYjKRLpubwHPYVFgsaBZ0s7TRdfC0YwBnatsOxqEiZMBXoH/1cCMCXXvL48AEEseWqaJQ/pv1Fw/ZnVX8pKU1OmGWQMnx1KxTUflLFv9Z0gk1AGCIRdslE1I9DFI6xOayjOqxU40T1HD+BlI164yR61cfmclYS493L4jxJxCZstk3mwZcNQfhrZbLun1Gbd6/3PoIukX5YXql/0tu83WqlTgPZdEGHKDzTaQjOGpaSTL2WNnkzaiaj0315BjajmJmfoXVE7hkA=
  file: grpc-*.tar.gz
  file_glob: true
  on:
    tags: true
